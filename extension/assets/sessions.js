import{a as M,u as O,r as o,d as B,e as q,f as K,j as e,P as k,g as H,h as W,i as J,B as $,S as _,T as A,b as Q,R as X}from"./index2.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=M("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=M("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);function V({prop:s,defaultProp:c,onChange:a=()=>{}}){const[r,l]=ee({defaultProp:c,onChange:a}),d=s!==void 0,u=d?s:r,h=O(a),f=o.useCallback(i=>{if(d){const x=typeof i=="function"?i(s):i;x!==s&&h(x)}else l(i)},[d,s,l,h]);return[u,f]}function ee({defaultProp:s,onChange:c}){const a=o.useState(s),[r]=a,l=o.useRef(r),d=O(c);return o.useEffect(()=>{l.current!==r&&(d(r),l.current=r)},[r,l,d]),a}var te=q.useId||(()=>{}),se=0;function ne(s){const[c,a]=o.useState(te());return B(()=>{s||a(r=>r??String(se++))},[s]),s||(c?`radix-${c}`:"")}var P="Collapsible",[oe,me]=K(P),[ae,I]=oe(P),G=o.forwardRef((s,c)=>{const{__scopeCollapsible:a,open:r,defaultOpen:l,disabled:d,onOpenChange:u,...h}=s,[f=!1,i]=V({prop:r,defaultProp:l,onChange:u});return e.jsx(ae,{scope:a,disabled:d,contentId:ne(),open:f,onOpenToggle:o.useCallback(()=>i(v=>!v),[i]),children:e.jsx(k.div,{"data-state":L(f),"data-disabled":d?"":void 0,...h,ref:c})})});G.displayName=P;var z="CollapsibleTrigger",D=o.forwardRef((s,c)=>{const{__scopeCollapsible:a,...r}=s,l=I(z,a);return e.jsx(k.button,{type:"button","aria-controls":l.contentId,"aria-expanded":l.open||!1,"data-state":L(l.open),"data-disabled":l.disabled?"":void 0,disabled:l.disabled,...r,ref:c,onClick:H(s.onClick,l.onOpenToggle)})});D.displayName=z;var F="CollapsibleContent",U=o.forwardRef((s,c)=>{const{forceMount:a,...r}=s,l=I(F,s.__scopeCollapsible);return e.jsx(W,{present:a||l.open,children:({present:d})=>e.jsx(re,{...r,ref:c,present:d})})});U.displayName=F;var re=o.forwardRef((s,c)=>{const{__scopeCollapsible:a,present:r,children:l,...d}=s,u=I(F,a),[h,f]=o.useState(r),i=o.useRef(null),v=J(c,i),x=o.useRef(0),g=x.current,w=o.useRef(0),N=w.current,y=u.open||h,C=o.useRef(y),b=o.useRef();return o.useEffect(()=>{const p=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(p)},[]),B(()=>{const p=i.current;if(p){b.current=b.current||{transitionDuration:p.style.transitionDuration,animationName:p.style.animationName},p.style.transitionDuration="0s",p.style.animationName="none";const R=p.getBoundingClientRect();x.current=R.height,w.current=R.width,C.current||(p.style.transitionDuration=b.current.transitionDuration,p.style.animationName=b.current.animationName),f(r)}},[u.open,r]),e.jsx(k.div,{"data-state":L(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!y,...d,ref:v,style:{"--radix-collapsible-content-height":g?`${g}px`:void 0,"--radix-collapsible-content-width":N?`${N}px`:void 0,...s.style},children:y&&l})});function L(s){return s?"open":"closed"}var le=G,ie=D,ce=U;const de=le,he=ie,ue=ce,T="http://localhost:5000";function fe(){const[s,c]=o.useState([]),[a,r]=o.useState(null),[l,d]=o.useState(null),[u,h]=o.useState(null),[f,i]=o.useState(!1),[v,x]=o.useState(0),[g,w]=o.useState(new Set);o.useEffect(()=>{N()},[v]);const N=async()=>{try{i(!0);const t=await fetch(`${T}/api/sessions`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"omit"});if(!t.ok)throw new Error("Failed to fetch sessions");const n=await t.json();c(n),h(null)}catch(t){h({type:"error",message:"Failed to load sessions"}),console.error("Error:",t)}finally{i(!1)}},y=async t=>{try{i(!0);const n=await fetch(`${T}/api/sessions/${encodeURIComponent(t)}`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"omit"});if(!n.ok)throw new Error("Failed to fetch file content");const m=await n.json();d(m.content),r(t),h(null)}catch(n){h({type:"error",message:"Failed to load file content"}),console.error("Error:",n)}finally{i(!1)}},C=async(t,n,m=!1)=>{if(n.stopPropagation(),!!confirm(`Are you sure you want to delete this ${m?"session":"file"}? ${m?"This will delete all files in the session.":""}`))try{i(!0);const j=await fetch(`${T}/api/sessions/${encodeURIComponent(t)}`,{method:"DELETE",mode:"cors",credentials:"omit"});if(!j.ok){const E=await j.json();throw new Error(E.error||"Failed to delete session")}x(E=>E+1),a!=null&&a.startsWith(t)&&(r(null),d(null)),h({type:"success",message:`${m?"Session":"File"} deleted successfully`}),setTimeout(()=>h(null),3e3)}catch(j){console.error("Error:",j),h({type:"error",message:j.message||`Failed to delete ${m?"session":"file"}`})}finally{i(!1)}},b=t=>{const n=new Set(g);n.has(t)?n.delete(t):n.add(t),w(n)},p=t=>new Date(t*1e3).toLocaleString(),R=t=>{const n=["B","KB","MB","GB"];let m=t,S=0;for(;m>1024&&S<n.length-1;)m/=1024,S++;return`${m.toFixed(1)} ${n[S]}`};return e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Saved Sessions"}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>x(t=>t+1),disabled:f,children:e.jsx(Z,{className:"h-4 w-4"})})]}),u&&e.jsx("div",{className:`${u.type==="success"?"bg-green-100 border-green-400 text-green-700":"bg-red-100 border-red-400 text-red-700"} px-4 py-3 rounded m-4 text-sm border`,children:u.message}),e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsx("div",{className:"w-1/3 border-r overflow-hidden flex flex-col",children:e.jsxs(_,{className:"flex-1",children:[f&&e.jsx("div",{className:"p-4 text-gray-500",children:"Loading..."}),!f&&s.length===0&&e.jsx("div",{className:"p-4 text-gray-500",children:"No saved sessions found"}),s.map(t=>e.jsxs(de,{open:g.has(t.name),className:"border-b",children:[e.jsxs(he,{className:"flex items-center justify-between w-full p-2 hover:bg-gray-100 group",onClick:()=>b(t.name),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:`h-4 w-4 mr-2 transition-transform ${g.has(t.name)?"transform rotate-90":""}`}),e.jsx("span",{className:"font-medium",children:t.name})]}),e.jsx($,{variant:"ghost",size:"sm",onClick:n=>C(t.name,n,!0),className:"opacity-0 group-hover:opacity-100 hover:bg-red-100 hover:text-red-600",children:e.jsx(A,{className:"h-4 w-4"})})]}),e.jsx(ue,{children:t.files.map(n=>e.jsxs("div",{onClick:()=>y(n.path),className:`flex items-center justify-between p-2 pl-8 hover:bg-gray-100 cursor-pointer ${a===n.path?"bg-blue-50":""}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm truncate",children:n.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[p(n.modified)," â€¢ ",R(n.size)]})]}),e.jsx($,{variant:"ghost",size:"sm",onClick:m=>C(n.path,m),className:"opacity-0 group-hover:opacity-100 hover:bg-red-100 hover:text-red-600",children:e.jsx(A,{className:"h-4 w-4"})})]},n.path))})]},t.name))]})}),e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:e.jsxs(_,{className:"flex-1 p-4",children:[f&&e.jsx("div",{className:"text-gray-500",children:"Loading content..."}),!f&&!a&&e.jsx("div",{className:"text-gray-500",children:"Select a session file to view its content"}),!f&&a&&l&&e.jsx("pre",{className:"text-sm whitespace-pre-wrap font-mono bg-gray-50 p-4 rounded-lg",children:l})]})})]})]})}Q.createRoot(document.getElementById("root")).render(e.jsx(X.StrictMode,{children:e.jsx(fe,{})}));
